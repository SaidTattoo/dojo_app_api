name: Ejecución Manual de LS

on:
  workflow_dispatch:

jobs:
  run-ls:
    runs-on: self-hosted
    steps:
    - name: Clonar repositorio
      uses: actions/checkout@v2

    - name: Extraer versión del mensaje de commit
      run: |
        VERSION_TAG=$(git log -1 --pretty=%B | grep -oE 'v[0-9]+\.[0-9]+\.[0-9]+')
        FILE_PATH=./deploy/docker-compose.yml # Actualiza esta ruta
        sed -i "s|image: gcr.io/road-321321/sigmamx:v.*|image: gcr.io/road-321321/sigmamx:${VERSION_TAG}|g" "${FILE_PATH}"
    - name: Imprimir PATH
      run: echo $PATH
    - name: Ejecutar comando LS
      run: ls -l